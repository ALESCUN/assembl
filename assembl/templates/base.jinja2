<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>{% block title %}Assebl{% endblock %}</title>

    <link type="text/css" rel="stylesheet" href="/static/css/style.css" />
</head>
<body class="preload">
    <div id="wrapper">
        <header id="header" class="container">
            <div class="bar bar--main">
                <div class="bar-left">
                    <a id="lateralmenu-button" class="iconbutton icon-reorder">
                        <span class="iconbutton-badge">2</span>
                    </a>

                    <img src="/static/img/assembl.png" alt="Assembl" />
                </div>
                <div class="bar-right">
                    <a class="iconbutton icon-search"> </a>
                    <a class="iconbutton icon-cog"> </a>
                    <a class="iconbutton icon-user"> </a>
                </div>
            </div>
            {% block extra_header %}{% endblock %}
        </header>
        <main id="main">
            {% block content %}{% endblock %}
        </main>
    </div>


    {% include 'includes/lateralmenu.jinja2' %}

    <script src="//cdnjs.cloudflare.com/ajax/libs/zepto/1.0/zepto.min.js"></script>
    <script>
        var app = {};

        !function($){
            app.Accordion = function (){
                'use strict';

                var self = this,
                    DATA_HEIGHT = 'data-accordion-height';

                function onHeaderClick(ev){
                    var area = $(ev.currentTarget).parent();

                    if( area.hasClass('is-open') ){
                        self.closeArea( area );
                    } else {
                        self.openArea( area );
                    }

                }

                this.openArea = function(area){
                    var body = area.find('.accordion-body'),
                        height = self.getBodyHeight(body);

                    area.addClass('is-open');
                    body.css('height', height);
                };

                this.closeArea = function(area){
                    area
                        .removeClass('is-open')
                        .find('.accordion-body')
                        .css('height', '0px');
                }

                this.getBodyHeight = function(body){
                    var height = body.attr(DATA_HEIGHT);

                    if( height == null ){

                        body.css({
                            position: 'absolute',
                            height: 'auto',
                            visibility: 'hidden'
                        });

                        height = body.height();

                        body
                            .css({
                                position: 'static',
                                height: '0px',
                                overflow: 'hidden',
                                visibility: 'visible'
                            })
                            .attr(DATA_HEIGHT, height+'px');
                    }

                    return height;
                };

                this.init = function( scope ){
                    $('.accordion-header', scope).on('click', onHeaderClick);
                };

            };

            (new app.Accordion).init();
        }(Zepto);

    </script>
    <script>
        !function($){
            $('#lateralmenu-button').click(function(ev){
                document.body.classList.toggle( 'is-lateralmenu-open' );
            });
        }(Zepto);
        $(function(){
            document.body.classList.remove('preload');
        });
    </script>
</body>
</html>
